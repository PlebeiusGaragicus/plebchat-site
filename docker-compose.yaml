# PlebChat Development Services
#
# Start all services:    docker compose up -d
# Start mint only:       docker compose up -d mint
# View logs:             docker compose logs -f mint
# Stop all:              docker compose down

services:
  # Local Cashu mint with FakeWallet backend (no real Lightning needed)
  # Mints unlimited fake sats for development/testing
  mint:
    image: cashubtc/nutshell:0.18.2
    container_name: plebchat-mint
    ports:
      - "3338:3338"
    environment:
      - MINT_BACKEND_BOLT11_SAT=FakeWallet
      - MINT_LISTEN_HOST=0.0.0.0
      - MINT_LISTEN_PORT=3338
      - MINT_PRIVATE_KEY=DEV_ONLY_TEST_KEY_DO_NOT_USE_IN_PRODUCTION
      - FAKEWALLET_BRR=TRUE
      - FAKEWALLET_DELAY_INCOMING_PAYMENT=0
      - FAKEWALLET_DELAY_OUTGOING_PAYMENT=0
    command: ["poetry", "run", "mint"]
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:3338/v1/info"]
      interval: 10s
      timeout: 5s
      retries: 3
    restart: unless-stopped
